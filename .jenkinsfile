pipeline {
    agent any

    stages {
        stage('build') {
            steps {
                echo 'Only git code is commited'
            }
        }
        stage('test') {
            steps {
                echo 'Docker job'
                sh 'sudo docker rm -f $(sudo docker ps -q -a)'
                sh 'sudo docker build /home/ubuntu/jenkins/workspace/test -t new'
                sh 'sudo docker run -it -p 80:80 -d new'
            }
        }
        
    }
}
